<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Funny Affirmations</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 40px; }
    .card { max-width: 680px; margin: auto; padding: 24px; border: 1px solid #4443; border-radius: 12px; box-shadow: 0 8px 30px #0001; }
    button, a { cursor: pointer; display: inline-block; padding: 10px 16px; border-radius: 10px; border: 1px solid #4443; text-decoration: none; }
    .big { font-size: 1.3rem; line-height: 1.5; }
    .muted { color: #666; font-size: 0.9rem; }
  </style>
</head>
<body>
  <div class="card">
    <h1>ü´∂ Funny Affirmations</h1>
    <p class="muted">Click the link to summon a ridiculous pick‚Äëme‚Äëup from Reddit.</p>

    <!-- ‚ÄúClick a link‚Äù requirement -->
    <p><a id="fetchLink" href="#">‚ú® give me one</a></p>

    <p class="big" id="line">‚Ä¶</p>
    <p class="muted" id="meta"></p>
  </div>

  <script>
    const link = document.getElementById('fetchLink');
    const line = document.getElementById('line');
    const meta = document.getElementById('meta');

    async function getOne() {
      line.textContent = 'loading‚Ä¶';
      meta.textContent = '';
      try {
        const r = await fetch('/random', { cache: 'no-store' });
        const j = await r.json();
        line.textContent = '‚Äú' + j.line + '‚Äù';
        meta.innerHTML = `from <b>r/${j.subreddit}</b> ‚Ä¢ <a href="${j.permalink}" target="_blank" rel="noopener">source</a> ‚Ä¢ ${j.ups} upvotes`;
      } catch(e) {
        line.textContent = 'failed to load ‚Äî try again';
      }
    }

    link.addEventListener('click', (e) => { e.preventDefault(); getOne(); });
    // load one on first visit
    getOne();
  </script>
</body>
</html>
